# Kubelens Parent Chart Values
# This chart only includes sub-charts (server and app)
# No resources are created directly by this chart

# Global settings (inherited by sub-charts)
global:
  imagePullSecrets: []

# Server sub-chart configuration
server:
  enabled: true
  replicaCount: 1
  
  image:
    repository: kubelensai/kubelens-server
    pullPolicy: Always
    tag: "latest"
  
  service:
    type: ClusterIP
    port: 8080
  
  serviceAccount:
    create: true
    annotations: {}
    name: ""
  
  rbac:
    create: true
  
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi
  
  env:
    - name: PORT
      value: "8080"
    - name: LOG_LEVEL
      value: "info"
    - name: DATABASE_PATH
      value: "/data/kubelens.db"
  
  persistence:
    enabled: true
    storageClass: ""
    accessMode: ReadWriteOnce
    size: 1Gi
  
  podAnnotations: {}
  
  podSecurityContext:
    fsGroup: 2000
  
  securityContext:
    capabilities:
      drop:
      - ALL
    readOnlyRootFilesystem: false
    runAsNonRoot: true
    runAsUser: 1000
  
  nodeSelector: {}
  tolerations: []
  affinity: {}

# App sub-chart configuration
app:
  enabled: true
  replicaCount: 1
  
  image:
    repository: kubelensai/kubelens-app
    pullPolicy: Always
    tag: "latest"
  
  service:
    type: ClusterIP
    port: 80
  
  ingress:
    enabled: false
    className: "nginx"
    annotations: {}
      # cert-manager.io/cluster-issuer: letsencrypt-prod
      # nginx.ingress.kubernetes.io/ssl-redirect: "true"
    hosts:
      - host: kubelens.app
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: kubelens-app-secret
        hosts:
          - kubelens.app
  
  resources:
    limits:
      cpu: 100m
      memory: 128Mi
    requests:
      cpu: 50m
      memory: 64Mi
  
  env:
    # API Server URL - auto-configured to point to server service
    apiServer: ""  # Will be set to http://<release-name>-server:8080
    extra: {}
  
  # Server service configuration for app to connect
  server:
    serviceName: ""  # Auto-detected from Release.Name
    servicePort: 8080
  
  podAnnotations: {}
  podSecurityContext: {}
  
  securityContext:
    capabilities:
      drop:
      - ALL
    readOnlyRootFilesystem: false
    runAsNonRoot: true
    runAsUser: 1000
  
  nodeSelector: {}
  tolerations: []
  affinity: {}
